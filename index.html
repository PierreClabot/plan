<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <h1>V1.6a</h1>
    <div class="container-fluid">
        <div class="row">
            

    <div class="col-12" data-name="TB_PLAN_SVG">
   
<script language="javascript" type="text/javascript">
function pcdClic(elem) {
alert('Clic '+elem);
}


</script>
<style>

img{
      display: inline-block;
      buffered-rendering : dynamic;
      position: absolute;
      
      top: 0;
      left: 0;
      user-select: none;
      /* transition: transform 0.2s; */
}
.place{
opacity:0.5;
}
.place:hover {
opacity:1;
}
div[data-name="PLAN-SALLE"]{
  overflow: hidden;
  position: relative;
  contain: paint;
  buffered-rendering : dynamic;
  height: 100%;
  border : black solid 1px;
}
.event{
  height: 300px;
  font-size:9px;
  font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
  overflow: scroll;
}

.btn-plan-container  {
   display:flex;
}

.btn-plan-commande {

  z-index: 2;
  margin: auto;
  cursor:pointer;
  text-align: center;
  background-color: #f1f1f1;
  padding : 0.1rem 0.5rem;
  border-radius: 10px 10px 0 0;
  border : solid 1px black
}
.blue{
  fill: blue !important;
}
</style>
<div>
  <h3>Nom de l'event</h3>
  <div class="event">

  </div>
</div>

<div class="btn-plan-container">
 <div class="btn-plan-commande" id="PLAN-CENTRER">Centrer</div>
 <div class="btn-plan-commande" id="PLAN-DEBUG-CLEAR">Clear Debug</div>
 <div class="btn-plan-commande" id="TEST-POSITION">TestPos 50,50</div>
</div>

<div data-name="PLAN-SALLE" style="text-align:center">

    <img class="img-fluid" src="svg.svg" alt="">



<script>

class PlanDeSalle{
  constructor()
  {
    const shape = document.querySelector("img");


    this.mouseStartPosition = {x: 0, y: 0};
    this.mousePosition = {x: 0, y: 0};
    this.viewboxStartPosition = {x: 0, y: 0};
    this.viewboxPosition = {x: 0, y: 0};
    this.viewboxSize = {x: 670, y: 1010};
    this.viewboxScale = 1.0;

    this.etatJeDeplace = false;
    this.nom = "plan de salle"
    this.calculHauteur();
    window.onresize = this.calculHauteur
    this.scale = 1;
    this.boolZoom = false;
    this.lastScale = 1;
    this.positionSVG = {
      X : 0,
      Y : 0,
    };
    this.AppuiA = {
      X:0,
      Y:0
    };
    
    this.historiquePos=[{x:0,y:0},{x:0,y:0}];
    
    this.myInterval = 0 ;
    this.dernierePositionSVG = {
      X:0,
      Y:0
    };
    this.maxY = 100;
    this.maxX = 200;
    this.clicSouris = false;
    this.curDiffInitial=1;
    this.prevDiff = -1;
    this.coeffGlisse = 0.95;
    this.coeffGlisseInitial = 0.95;
    this.scale = 1;
    const svg = document.querySelector("img");
    const container = document.querySelector("div[data-name=PLAN-SALLE]");

    //@MODIF
    //const btnCentrer = 
    //---

    this.scaleWheelDeltaY = 1;

    //@MODIF
    document.querySelector("#PLAN-DEBUG-CLEAR").addEventListener("click",(e)=>{
      this.debugClear();
    });

    //@MODIF
    document.querySelector("#TEST-POSITION").addEventListener("click",(e)=>{
      console.log("TST POS");
      this.svgPosition({X:50,Y:50});
      
      // dbg--
      let p=this.svgPositionDonne();
      this.debug("pos svg="+this.pointVersChaine("Sbg pos_1=",p));
      //--dbg
    });


    document.querySelector("#PLAN-CENTRER").addEventListener("click",(e)=>{
      this.debug("Centrer !");      
      if(this.myInterval)
      {
        clearInterval(this.myInterval);
      }

      svg.style.transform = "scale(1)";
      this.positionSVG = {
        X : 0,
        Y : 0
      }
      
      this.svgPosition({X:0,Y:0});
      //svg.style.top = `${this.positionSVG.Y}px`;
      //svg.style.left = `${this.positionSVG.X}px`;
      this.scale = 1
      this.lastScale = 1;

      //scale = 1;
      // document.querySelector(".event").innerHTML = `Appui sur le bouton centrer<br>
      //                                               dernierPositionSVG : <br>
      //                                               X :  ${this.dernierePositionSVG.X}<br>
      //                                               Y :  ${this.dernierePositionSVG.Y}`;
      //this.debug("J'appuie sur le bouton centrer");
    });

    // btnCentrer.addEventListener("click",(e)=>{
    //   console.log("btn-centrer");
    //   this.positionSVG = {
    //     X : 0,
    //     Y : 0
    //   }
    //   svg.style.left = `${this.positionSVG.X}px`;
    //   svg.style.top = `${this.positionSVG.Y}px`;
    //   //svg.style.transform = `translate(${this.positionSVG.X}px,${this.positionSVG.Y}px) scale(1)`;

    //   //@MODIF
    //   this.dernierePositionSVG = { X:this.positionSVG.X , Y:this.positionSVG.Y };
    //   this.nouvellePositionSVG = { X:this.positionSVG.X , Y:this.positionSVG.X };
    //   this.AppuiA = {
    //     X : 0,
    //     Y : 0
    //   }
    //   //@----

    //   //@MODIF
    //   this.AppuiB = { X:this.AppuiA.X , Y:this.AppuiA.Y };
    //   //@----

    //   this.scale = 1;
    //   this.lastScale = 1;
      
    //   //this.debug(`J'appuie sur le bouton centrer, svg en position ${this.positionSVG.X}px,${this.positionSVG.Y}px`);
    // })


    // container.addEventListener("pointerdown",e=>{
    //   // e.stopPropagation();
    //   // e.preventDefault(); 
    //   // this.pointers.push(e);
    //   // this.appuiEn(e,e.clientX,e.clientY)
    //   // console.log(e);
    //   // console.log("X : "+e.clientX);
    //   // console.log("Y : "+e.clientY);
    //   // this.appuiEn(e,e.clientX, e.clientY);
    // })
    container.addEventListener("touchstart",e=>{
      
      //this.debug("e.touchlen="+e.touches.length);
      e.stopPropagation();
      e.preventDefault(); 
      
      
      if (e.touches.length>1) {
        this.etatJeDeplace=false;
        this.debug("initStart");
        this.curDiffInitial=this.norme2Points( {X:e.touches[0].clientX,Y:e.touches[0].clientY }, {X:e.touches[1].clientX,Y:e.touches[1].clientY } );
        this.debug("CUR DIF NINIT="+this.curDiffInitial);
      }

      if (e.touches.length==1) {
         this.appuiEn(e,e.clientX,e.clientY)
      }
      // console.log(e);
      // console.log("X : "+e.clientX);
      // console.log("Y : "+e.clientY);
      // this.appuiEn(e,e.clientX, e.clientY);
    })

//     container.addEventListener("pointermove",e=>{
//       return;
//       e.stopPropagation();
//       e.preventDefault(); 

//       for (var i = 0; i < this.pointers.length; i++) {
//         if (e.pointerId == this.pointers[i].pointerId) {
//           this.pointers[i] = e;
//           break;
//         }
//       }

//       console.log("event",e);
//       if (this.pointers.length == 2) 
//       {
//         // Calculate the distance between the two pointers
//         //this.debug("J'ai 2 doigts");
//         var curDiff = Math.sqrt(Math.pow(this.pointers[1].clientX - this.pointers[0].clientX, 2) + Math.pow(this.pointers[1].clientY - this.pointers[0].clientY, 2));
//         document.querySelector(".event").innerHTML = `scale : ${e.scale}`;
//         let scaleZoom = curDiff;
//         if(scaleZoom < 5 )
//         {
//           scaleZoom = 5;
//         }
//         if(scaleZoom > 20 )
//         {
//           scaleZoom = 20;
//         }
//         if (this.prevDiff > 2) 
//         {
//           //scale;
//           if (curDiff > this.prevDiff) { // ZOOM
//             this.lastScale = this.scale;
//             scale = this.scale + scaleZoom/100;
//             this.zoom(e,scale);
//           }
//           if (curDiff < this.prevDiff) { // DEZOOM
//             this.lastScale = this.scale;
//             scale = this.scale - scaleZoom/100;
//             this.zoom(e,scale);
//           }
//         }
//         // Cache the distance for the next move event 
//         this.prevDiff = curDiff;
//       }
//       else if (this.pointers.length == 1)
//       {
//         this.bougerEn(e,e.clientX,e.clientY);
//       }
// })
    svg.addEventListener("click",(e)=>{
      
      
    })
    // container.addEventListener("pointerup",e=>{
    //   return;
    //   e.stopPropagation();
    //   e.preventDefault(); 
    //   this.lever();
    //   for (var i = 0; i < this.pointers.length; i++) {
    //     if (this.pointers[i].pointerId == e.pointerId) {
    //       this.pointers.splice(i, 1);
    //       break;
    //     }
    //   }

    //   if (this.pointers.length < 2) 
    //   {
    //     this.prevDiff = -1;
    //   }
    //   // this.lever(e);  
    // })

    container.addEventListener("mousedown", e =>{
      this.appuiEn(e,e.clientX, e.clientY);
      // this.debug(`Mouse Down<br>
      //             ClientX : ${e.clientX}<br>
      //             ClientY : ${e.clientY}<br>`);
    })
    container.addEventListener("touchmove",(e)=>{
      console.log("**TOUC MOV");
        try{

        
        e.stopPropagation();
        e.preventDefault(); 
        
        if(e.touches.length > 1) // Plusieurs doigts simultanés
        {
          let curDiff=this.norme2Points( {X:e.touches[0].clientX,Y:e.touches[0].clientY }, {X:e.touches[1].clientX,Y:e.touches[1].clientY } );
          //let curDiff = Math.sqrt(Math.pow(e.touches[1].clientX - e.touches[0].clientX, 2) + Math.pow(e.touches[1].clientY - e.touches[0].clientY, 2));
          // document.querySelector(".event").innerHTML = `scale : ${e.scale}`;
          // this.debug(curDiff);
          // let scaleZoom = curDiff;
          // if(scaleZoom < 5 )
          // {
          //   scaleZoom = 5;
          // }
          // if(scaleZoom > 20 )
          // {
          //   scaleZoom = 20;
          // }
          // if (this.prevDiff > 2) 
          // {
          //   //scale;
          //   if (curDiff > this.prevDiff) { // ZOOM
          //     this.lastScale = this.scale;
          //     scale = this.scale + scaleZoom/100;
          //     //this.zoom(e,scale);
          //   }
          //   if (curDiff < this.prevDiff) { // DEZOOM
          //     this.lastScale = this.scale;
          //     scale = this.scale - scaleZoom/100;
          //     //this.zoom(e,scale);
          //   }
          // }
          // // Cache the distance for the next move event 
          // this.prevDiff = curDiff;
          
          let scaleFacteur=curDiff-this.curDiffInitial;
          this.debug("scalle Facteur="+scaleFacteur);
          let paramScale = 0;
          if (scaleFacteur>0.2) { paramScale=0.01; this.debug("ZOOM");}
          if (scaleFacteur<0.2) { paramScale=-0.01; this.debug("DEZOOM");}
          this.zoom(e,paramScale);

        }
        if(e.touches.length == 1)
        {
          //this.prevDiff = -1;
          // document.querySelector(".event").innerHTML = `e.touches[0] : <br>
          //                                               clientX : ${e.touches[0].clientX}<br>
          //                                               clientY : ${e.touches[0].clientY}<br>`;
          this.bougerEn(e,e.touches[0].clientX , e.touches[0].clientY);
        }
      }
      catch(error){
        this.debug("error name"+error.name);
        this.debug("error message"+error.message);
      }

    })
    container.addEventListener("wheel", e=>{
      this.debug(`e wheel deltay=${e.wheelDeltaY}`);
      e.stopPropagation();
      e.preventDefault();
      this.debug("deltaY",e.wheelDeltaY);
      this.zoom(e,e.wheelDeltaY/480);
      return;
      
      if(e.wheelDeltaY < 0) // DZZOOM
      {
        scaleWheelDeltaY -= 0.1;
      }
      else // ZOOM
      {
        scaleWheelDeltaY += 0.1;
      }

      //this.debug("scaleWheelDeltaY : "+scaleWheelDeltaY)
      this.zoom(e,scaleWheelDeltaY);
    })

    //@MODIF
     container.addEventListener("mousemove",(e)=>{
         // --return;
         e.stopPropagation();
         e.preventDefault(); 
         this.bougerEn(e,e.clientX , e.clientY);
    });

    container.addEventListener("mouseup",(e)=>{
         // --return;
         e.stopPropagation();
         e.preventDefault(); 
         this.lever(e);
    });
    //@---

    container.addEventListener("touchend",(e)=>{
        e.stopPropagation();
        e.preventDefault(); 
        this.lever(e);   
    })
    // container.addEventListener("mouseup",(e)=>{
    //     return;
    //     e.stopPropagation();
    //     e.preventDefault(); 
    //     this.lever(e);   
    // })
    // container.addEventListener("touchcancel",(e)=>{
    //   return;
    //   e.stopPropagation();
    //   e.preventDefault(); 
    //   // this.debug(e.type);
    //   // this.debug(`target : ${e.target.classList.value}`);

    // })

    //
    this.debug("Event handlers");

    //shape.addEventListener("mousemove", ()=>{this.mousemove});
    //shape.addEventListener("mousedown", ()=>{this.mousedown});
    //shape.addEventListener("wheel", ()=>{this.wheel});

  }




  mousedown(e) {
    this.debug('*************"MOUSE DOWN "');
    mouseStartPosition.x = e.pageX;
    mouseStartPosition.y = e.pageY;

    viewboxStartPosition.x = viewboxPosition.x;
    viewboxStartPosition.y = viewboxPosition.y;

    window.addEventListener("mouseup", this.mouseup);

    
}




calculHauteur(){
  let divTop = document.querySelector("div[data-name=PLAN-SALLE]").offsetTop;
  let hauteurEcran = document.documentElement.clientHeight;
  let difference = hauteurEcran - divTop;
  document.querySelector("div[data-name=PLAN-SALLE]").style.height = difference+"px";
}



appuiEn(e,x,y){
    //this.debug(`appuiEn (${x},${y})`);
    
    this.historiquePos[0]={
      X: x,
      Y: y,
    }

    this.historiquePos[1]={
      X: x,
      Y: y,
    }

    this.etatJeDeplace=true;
    
    //this.clicSouris = true;
    if(this.myInterval) // @TODO method stopglisse
    {
      clearInterval(this.myInterval)
    }
    //console.log(this);
    // document.querySelector(".event").innerHTML =`dernièrePositionSVG : <br>
    //                                   X : ${this.dernierePositionSVG.X}<br>
    //                                   Y : ${this.dernierePositionSVG.Y}<br>`
    // this.debug(e.type);
    // this.debug(`target : ${e.target.classList.value}`);
    // this.debug(`this : ${this.nom}`)
}





bougerEn(event,x,y)
{
   
  if(this.etatJeDeplace)
  {

    this.historiquePos[0]={
      X : this.historiquePos[1].X ,
      Y : this.historiquePos[1].Y
    }
    this.historiquePos[1]={
      X : x,
      Y : y
    }

    this.vecteur={
      X:this.historiquePos[1].X - this.historiquePos[0].X,
      Y:this.historiquePos[1].Y - this.historiquePos[0].Y,
    }
    
    
    let posActuelle=this.svgPositionDonne();
    
    //this.debug("pos="+this.pointVersChaine("-posSvg=",posActuelle)+" Vecteur deplacement="+this.pointVersChaine("Vect depla=",this.vecteur));
    //@MODIF
    posActuelle.X+=this.vecteur.X;
    posActuelle.Y+=this.vecteur.Y;
    //this.debug("pos="+this.pointVersChaine("+newPOS=",posActuelle)+" Vecteur deplacement=");
    this.svgPosition(posActuelle);
    
    //this.debug("pos="+this.pointVersChaine("+REALPOS=",posActuelle)+" Vecteur deplacement=");
    
    
    //this.debug(this.pointVersChaine("svg pos=",posActuelle));
    //this.debug("-----------");

    // document.querySelector(".event").innerHTML += `je bouge<br>
    //                                               premierAppui : <br>
    //                                               X : ${this.premierAppui.X}<br>
    //                                               Y : ${this.premierAppui.Y}<br>
    //                                               position SVG : <br>
    //                                               X : ${this.positionSVG.X}<br>
    //                                               Y : ${this.positionSVG.Y}<br>
    //                                               dernièrePositionSVG : <br>
    //                                               X : ${this.dernierePositionSVG.X}<br>
    //                                               Y : ${this.dernierePositionSVG.Y}<br>`
    // this.debug(`${event.type} : je me déplace`)
    // this.debug(`target : ${event.target.classList.value}`);
    // this.debug(`Je suis : ${this.nom}`)
    // this.debug(`Position du SVG : { X : ${this.positionSVG.X}, Y :${this.positionSVG.Y} }`);
  }

}





zoom(e,scale)
{

  console.log("***ZOOM");
  this.scale+=scale;
  this.debug("param scale "+scale)
  this.debug("this.scale "+this.scale)
  if(this.scale > 4){ this.scale = 4;}
  if(this.scale < 0.8){ this.scale = 0.8;}

  // this.boolPremierAppui = true;
  // if(this.scale == 1)
  // {
  //   this.scale = scale;
  // }

  // if (scale>=this.lastScale) // Zoom
  // {
  //   this.scale += (scale-this.lastScale);
  // }
  // else{ // Dezoom
  //   this.scale -= (this.lastScale-scale);
  // }
  // if(this.scale>4) // Limiter l'échelle de zoom / dezoom
  // {
  //   this.scale = 4
  // }
  // if(this.scale <0.8)
  // {
  //   this.scale = 0.8;
  // }

  //this.debug(`${e.type} : je zoom`);
  // this.debug(`target : ${e.target.classList.value}`);
  // this.debug(`Je suis : ${this.nom}`);
  // this.debug(`Typeof scale : ${typeof this.scale}`);
  // this.debug(`Valeur scale : ${this.scale}`);
  // this.debug(`Typeof lastScale : ${typeof this.lastScale}`);
  // this.debug(`Valeur lastScale : ${this.lastScale}`);
  // this.debug(`Touche 1 : { X : ${e.touches[0].clientX}, Y : ${e.touches[0].clientY} }`)
  // this.debug(`Touche 2 : { X : ${e.touches[1].clientX}, Y : ${e.touches[1].clientY} }`)


  

  document.querySelector("img").style.transform = `scale(${this.scale})`; // passer en méthode @TODO
  this.lastScale=this.scale;
  // document.querySelector("svg").style.transform = `translate(${this.dernierePositionSVG.X}px,${this.dernierePositionSVG.Y}px) scale(${this.scale})`;
}







lever(event)
{
  //@MODIF
  //--this.dernierePositionSVG=this.positionSVG;
  
  this.etatJeDeplace=false;
  
  let norme = Math.sqrt((this.vecteur.X * this.vecteur.X)+(this.vecteur.Y * this.vecteur.Y)); // utiliser methode
  if(norme > 10)
  {
    this.vecteur.X = this.vecteur.X/norme;
    this.vecteur.Y = this.vecteur.Y/norme;
    this.vecteur.X = this.vecteur.X * 10;
    this.vecteur.Y = this.vecteur.Y * 10;
  }
  // Calculer le vecteur vitesse
  // mémoriser la position du svg
  if(this.myInterval)
  {
    clearInterval(this.myInterval)
  }
  // this.debug(`${event.type}`)
  // this.debug(`target : ${event.target.classList.value}`);
  // this.debug(`Je suis : ${this.nom}`)
  this.coeffGlisse = this.coeffGlisseInitial;
  this.myInterval = setInterval(this.defilementScroll.bind(planDeSalle),30);

  this.boolZoom = true;
  this.lastScale = 1;
  this.boolPremierAppui =  true;
  this.clicSouris = false;

}







defilementScroll()
{
  
  // Bouger le SVG avec le vecteur vitesse
  // Diminuer le vecteur vitesse
  // Si vecteur vitesse < 1 trop petit alors désactiver setInterval 
  // document.querySelector("svg").style.transition = "transform 0.2s";

  let SVGPos=this.svgPositionDonne();
  
  SVGPos = {
    X : this.vecteur.X + SVGPos.X,
    Y : this.vecteur.Y + SVGPos.Y
  }

  this.vecteur = {
    X : this.vecteur.X * this.coeffGlisse, // 0.95
    Y : this.vecteur.Y * this.coeffGlisse  // 0.95
  }

  this.coeffGlisse = this.coeffGlisse * 0.95;
  

  this.svgPosition(SVGPos);

  // this.debug(`Défilement scroll`);
  // this.debug(`Je suis : ${this.nom}`)
  // this.debug(`vecteur : <br>{ X : ${difference.X}, Y : ${difference.Y} }`);
  // this.debug(`Nouvelle Position SVG : <br>{ X : ${nouvellePositionSVG.X}, Y : ${nouvellePositionSVG.Y} }`);
  // if(Math.abs(nouvellePositionSVG.X)>(this.maxX * this.scale))
  // {
  //   nouvellePositionSVG.X = this.maxX * this.scale * (nouvellePositionSVG.X/(Math.abs(nouvellePositionSVG.X)));
  //   clearInterval(this.myInterval);
    
  // }
  // if(Math.abs(nouvellePositionSVG.Y)>(this.maxY * this.scale))
  // {
  //   nouvellePositionSVG.Y = this.maxY * this.scale *(nouvellePositionSVG.Y/(Math.abs(nouvellePositionSVG.Y)));
  //   clearInterval(this.myInterval);
  // }

  //@MODIF
  //--this.positionSVG = nouvellePositionSVG;
  //this.positionSVG = {X:nouvellePositionSVG.X, Y:nouvellePositionSVG.Y }
  //----
  
  let norme = Math.sqrt((this.vecteur.X * this.vecteur.X)+(this.vecteur.Y * this.vecteur.Y))
  if(norme < 1)
  {
    //this.debug("Je sors de mon setInterval");
    if(this.myInterval)
    {
      clearInterval(this.myInterval);
    }
    return;
  }
  
  // document.querySelector("svg").style.transform = `translate(${nouvellePositionSVG.X}px,${nouvellePositionSVG.Y}px) scale(${this.scale})`
  
  //@MODIF
  //--this.dernierePositionSVG = this.positionSVG;
  this.dernierePositionSVG = { X:this.positionSVG.X , Y:this.positionSVG.Y };
  //@-----
}



setviewbox() // inutile ?
{
  console.log("****** SET VIEW BOX");
  var vp = {x: viewboxPosition.x ,  y:viewboxPosition.y};
  var vs = {x: viewboxSize.x * viewboxScale , y:  viewboxSize.y * viewboxScale};
  shape = document.getElementsByTagName("svg")[0];
  shape.setAttribute("viewBox", vp.x + " " + vp.y + " " + vs.x + " " + vs.y);
}



mousemove(e) // debug
{
  console.log("******** MOUS  MOVE");
  mousePosition.x = e.offsetX;
  mousePosition.y = e.offsetY;
  
  if (mouseDown)
  {
    viewboxPosition.x = viewboxStartPosition.x + (mouseStartPosition.x - e.pageX) * viewboxScale;
    viewboxPosition.y = viewboxStartPosition.y + (mouseStartPosition.y - e.pageY) * viewboxScale;

    this.setviewbox();
  }
  
  var mpos = {x: mousePosition.x * viewboxScale, y: mousePosition.y * viewboxScale};
  var vpos = {x: viewboxPosition.x, y: viewboxPosition.y};
  var cpos = {x: mpos.x + vpos.x, y: mpos.y + vpos.y}
}



mouseup(e) { // debug
  console.log("*****MOUSEU");
  window.removeEventListener("mouseup", this.mouseup);
  //mouseDown = false;
}




wheel(e) { // pour debug
  this.debug("***WHHHHHHH");
  return;
  var scale = (e.deltaY < 0) ? 0.8 : 1.2;
  
  if ((viewboxScale * scale < 8.0) && (viewboxScale * scale > 1.0/256.0))
  {  
    var mpos = {x: mousePosition.x * viewboxScale, y: mousePosition.y * viewboxScale};
    var vpos = {x: viewboxPosition.x, y: viewboxPosition.y};
    var cpos = {x: mpos.x + vpos.x, y: mpos.y + vpos.y}

    viewboxPosition.x = (viewboxPosition.x - cpos.x) * scale + cpos.x;
    viewboxPosition.y = (viewboxPosition.y - cpos.y) * scale + cpos.y;
    viewboxScale *= scale;
  
    this.setviewbox();
  }
}


svgPosition(point) {
  let domElement=document.querySelector("img"); // A modifier
  domElement.style.left = `${point.X}px`;
  domElement.style.top  = `${point.Y}px`;
}



svgPositionDonne() {
  let domElement=document.querySelector("img"); // A modifier
  let point= { 
                X : domElement.offsetLeft, 
                Y : domElement.offsetTop, 
              };
  return point;
}



debug(chaine)
{
  console.log(chaine);
  document.querySelector(".event").innerHTML += "<br>"+chaine;
}



pointVersChaine(chaInfo,p) {
  let chaRet=`${chaInfo}=(${p.X},${p.Y})`;
  return chaRet;
}

debugClear()
{
  document.querySelector(".event").innerHTML = ""
}

norme2Points(p1,p2) {
 let norme= Math.sqrt(  (p1.X - p2.X)*(p1.X - p2.X) + (p1.Y - p2.Y)*(p1.Y - p2.Y) );
 return norme;
}

}
// function pcdNavWLValiderSiegesRpr(place)
// {
//   alert(place);
// }

const planDeSalle = new PlanDeSalle();
</script>
 </div>
  </div>
</div>
</div>

</body> 
</html>